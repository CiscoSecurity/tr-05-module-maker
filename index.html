<!DOCTYPE html>
<html lang="en">
<head>
    <title>Module Maker</title>
    <link rel="stylesheet" href="index.css">
    <script src="index.js" defer></script>
</head>

<body>
<div class="root">
    <div class="header">
        <div class="header-logo">
            <svg>
                <use href="icons/sprite.svg#icon-cisco-logo"></use>
            </svg>
        </div>
        <div class="header-title">Threat Response Module Maker</div>
    </div>

    <div class="breadcrumb">
        <p class="breadcrumb-element">Settings > Module</p>
    </div>

    <div class="site">
        <div class="sidebar">
            <div class="sidebar-header">
                Settings
            </div>
            <ul>
                <input type="file" id="jsonFile" style="display:none" accept="application/JSON">
                <li class="sidebar-item" id="openJSONFile">
                    Open JSON from File
                </li>
                <li class="sidebar-item" id="openJSONAPI">
                    Open JSON from TR API
                </li>
            </ul>
        </div>

        <div class="content">
            <h1>Module</h1>
            <div id="modalForPull" class="modal">
                <div class="modal-content">
                    <span class="close">
                        <svg>
                            <use href="icons/sprite.svg#icon-small-x-close"></use>
                        </svg>
                    </span>
                    <p class="controls-option-text">
                        Pull module type from your Threat Response organization.
                    </p>
                    <form id="pull-module-type-form">
                        <label class="centered">Client ID
                            <input type="text" class="creds" name="pull-client-id">
                        </label>
                        <label class="centered">Client Password
                            <input type="password" name="pull-client-password"  class="creds">
                        </label>
                        <label class="centered">Module Type ID
                            <input type="text" name="module-type-id">
                        </label>
                        <button type="button" class="controls-button centered" onclick="pull()">Pull
                        </button>
                    </form>
                </div>

            </div>

            <div class="inputs">

                <form id="configuration" method="POST" class="inputs-column" enctype=multipart/form-data>
                    <label>Title
                        <input type="text" name="title" required maxlength="40" id="title" autocomplete="off">
                    </label>
                    <label>Default Name
                        <input type="text" name="default-name" required maxlength="40" autocomplete="off">
                    </label>
                    <label>Short Description
                        <input type="text" name="short-description" maxlength="140" autocomplete="off">
                    </label>

                    <p>Configuration Spec</p>
                    <fieldset>
                        <div class="icon">
                            <svg id="addConfigIcon">
                                <use href="icons/sprite.svg#icon-add"></use>
                            </svg>
                            <svg id="removeConfigIcon">
                                <use href="icons/sprite.svg#icon-remove"></use>
                            </svg>
                        </div>
                        <div id="wrapper" class="wrapper">
                        </div>
                    </fieldset>
                    <p>Properties</p>
                    <fieldset>
                        <label>Supported APIs</label>
                        <fieldset name="properties">
                            <div>
                                <input type="checkbox" id="health" name="health" class="health" autocomplete="off">
                                <label for="health">health</label>
                            </div>
                            <div>
                                <input type="checkbox" id="deliberate/observables" class="deliberate" autocomplete="off">
                                <label for="deliberate/observables">deliberate/observables</label>
                            </div>
                            <div>
                                <input type="checkbox" id="refer/observables" class="refer" autocomplete="off">
                                <label for="refer/observables">refer/observables</label>
                            </div>
                            <div>
                                <input type="checkbox" id="observe/observables" class="observe" autocomplete="off">
                                <label for="observe/observables">observe/observables</label>
                            </div>

                            <div>
                                <input type="checkbox" id="respond/observables" class="respond" autocomplete="off">
                                <label for="respond/observables">respond/observables</label>
                            </div>

                            <div>
                                <input type="checkbox" id="respond/trigger" class="respond" autocomplete="off">
                                <label for="respond/trigger">respond/trigger</label>
                            </div>

                            <div>
                                <input type="checkbox" id="tiles" class="tiles" autocomplete="off">
                                <label for="tiles">tiles</label>
                            </div>
                            <div>
                                <input type="checkbox" id="tiles/tile" class="tiles" autocomplete="off">
                                <label for="tiles/tile">tiles/tile</label>
                            </div>
                            <div>
                                <input type="checkbox" id="tiles/tile-data" class="tiles" autocomplete="off">
                                <label for="tiles/tile-data">tiles/tile-data</label>
                            </div>
                        </fieldset>

                        <p>Auth-type</p>
                        <fieldset name="auth-type">
                            <div>
                                <input type="checkbox" id="auth_type" autocomplete="off"
                                       onchange="showAuthSelectMenu('select_auth', 'auth_type')">
                                <label for="auth_type">authorization</label>
                                <select id="select_auth">
                                    <option>basic</option>
                                    <option>authorization-header</option>
                                    <option>bearer</option>
                                </select>
                            </div>
                        </fieldset>

                    </fieldset>

                    <label>Flags
                        <input type="text" name="flags" placeholder="Enter flags separated by commas"
                               form="configuration" autocomplete="off">
                    </label>

                    <div id="drop-area">
                        <label>Logo
                            <input type="file" accept="image/*" name="logo" form="configuration" id="logo"
                                   autocomplete="off">
                        </label>
                    </div>

                </form>

                <div class="inputs-column">

                    <label>Description
                        <textarea name="description" form="configuration" autocomplete="off"></textarea>
                    </label>
                    <label>Tips
                        <textarea name="tips" form="configuration" autocomplete="off"></textarea>
                    </label>

                    <p>Capabilities</p>
                    <fieldset id="capabilities-fieldset">
                        <p>Select one of the Supported APIs to write a description.</p>
                    </fieldset>

                    <p>External References</p>
                    <fieldset class="external-references">
                        <div>
                            <input type="checkbox" id="FreeTrial" class="references-checkbox"
                                   autocomplete="off" onchange="showInputForLinks(this.id)" form="configuration">
                            <label for="FreeTrial">Free Trial</label>
                            <input type="text" id="FreeTrialValue" form="configuration" class="hidden-input"
                                   name="Free Trial" autocomplete="off">
                        </div>
                        <div>
                            <input type="checkbox" id="SignUp" class="references-checkbox" autocomplete="off"
                                   onchange="showInputForLinks(this.id)" form="configuration">
                            <label for="SignUp">Sign Up</label>
                            <input type="text" id="SignUpValue" form="configuration" class="hidden-input"
                                   name="Sign Up" autocomplete="off">
                        </div>
                        <div>
                            <input type="checkbox" id="ContactUs" class="references-checkbox"
                                   autocomplete="off" onchange="showInputForLinks(this.id)" form="configuration">
                            <label for="ContactUs">Contact Us</label>
                            <input type="text" id="ContactUsValue" form="configuration" class="hidden-input"
                                   name="Contact Us" autocomplete="off">
                        </div>
                        <div class="link-label-pairs">
                            <input type="text" form="configuration" placeholder="Enter label" class="input-reference"
                                   autocomplete="off">
                            <input type="text" form="configuration" placeholder="Enter link" class="input-reference"
                                   autocomplete="off">
                        </div>
                        <div class="link-label-pairs">
                            <input type="text" form="configuration" placeholder="Enter label" class="input-reference"
                                   autocomplete="off">
                            <input type="text" form="configuration" placeholder="Enter link" class="input-reference"
                                   autocomplete="off">
                        </div>
                    </fieldset>

                </div>
            </div>

            <div class="controls">
                <div class="controls-option">
                    <p class="controls-option-text">
                        Create a new module type in your Threat Response organization.
                    </p>

                    <label class="centered">Client ID
                        <input type="text" name="client-id" id="client-id"  class="creds" required>
                    </label>
                    <label class="centered">Client Password
                        <input type="password" name="client-password" id="client-password" class="creds" required>
                    </label>

                    <button type="button" class="controls-button centered" form="configuration" onclick="push()">Push
                    </button>
                </div>

                <div class="controls-option">
                    <p class="controls-option-text">
                        Save the configuration of a module type as a JSON file.
                    </p>

                    <button type="button" class="controls-button centered" form="configuration" onclick="save()">Save
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
